{% extends '_layout' %}

{% block content %}
  <section aria-labelledby="gallery-title" class="space-y-6">
    <h1 id="gallery-title" class="page-title">{{ entry.title }}</h1>

    {% set photos = craft.entries()
      .section(entry.title)
      .status('live')
      .orderBy('postDate desc')
      .all()
    %}

    <ul class="grid gap-4 sm:grid-cols-2 lg:grid-cols-3" role="list">
      {% for photo in photos %}
        {% set img = photo.image.one() %}
        {% if img %}
          {% set altText = img.alt ?? photo.title %}
          {% set transformedUrl = img.getUrl('fit') ?? img.url %}
          {% set transformedWidth = img.getWidth('fit') ?? img.width ?? null %}
          {% set transformedHeight = img.getHeight('fit') ?? img.height ?? null %}

          <li class="card p-0">
            <div class="aspect-[4/5] overflow-hidden rounded-lg">
              {% if photo.url %}
                <a class="block h-full w-full focus-visible:outline-none focus-visible:ring focus-visible:ring-brand/50" href="{{ photo.url }}">
                  <img
                    class="h-full w-full object-cover"
                    src="{{ transformedUrl }}"
                    alt="{{ altText }}"
                    loading="lazy"
                    width="{{ transformedWidth }}"
                    height="{{ transformedHeight }}"
                  >
                </a>
              {% else %}
                <img
                  class="h-full w-full object-cover"
                  src="{{ transformedUrl }}"
                  alt="{{ altText }}"
                  loading="lazy"
                  width="{{ transformedWidth }}"
                  height="{{ transformedHeight }}"
                >
              {% endif %}
            </div>
          </li>
        {% endif %}
      {% endfor %}
    </ul>
  </section>
{% endblock %}
